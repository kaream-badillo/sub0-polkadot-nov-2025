version: "3.9"

services:
  api:
    image: ${API_IMAGE:-TODO_API_IMAGE}
    container_name: crosschain-api
    environment:
      - NODE_ENV=production
      - API_PORT=${API_PORT:-3000}
      - LOG_LEVEL=${LOG_LEVEL:-info}
      - API_RATE_LIMIT_PER_MINUTE=${API_RATE_LIMIT_PER_MINUTE:-60}
      - HYPERBRIDGE_RPC_URL=${HYPERBRIDGE_RPC_URL:-TODO_HYPERBRIDGE_RPC_URL}
      - HYPERBRIDGE_WS_URL=${HYPERBRIDGE_WS_URL:-wss://TODO_HYPERBRIDGE_WS_URL}
      - HYPERBRIDGE_STATE_MACHINE_ID=${HYPERBRIDGE_STATE_MACHINE_ID:-TODO_STATE_MACHINE_ID}
      - HYPERBRIDGE_CONSENSUS_STATE_ID=${HYPERBRIDGE_CONSENSUS_STATE_ID:-TODO_CONSENSUS_STATE_ID}
      - HYPERBRIDGE_HASHER=${HYPERBRIDGE_HASHER:-Keccak}
      - ENABLE_HYPERBRIDGE=${ENABLE_HYPERBRIDGE:-true}
      - ENABLE_EVM_CHAINS=${ENABLE_EVM_CHAINS:-true}
      - ENABLE_ALERTS=${ENABLE_ALERTS:-false}
      - POLKADOT_RPC_URL=${POLKADOT_RPC_URL:-wss://TODO_POLKADOT_RPC_URL}
      - LISK_TESTNET_RPC_URL=${LISK_TESTNET_RPC_URL:-https://TODO_LISK_TESTNET_RPC_URL}
      - ETHEREUM_RPC_URL=${ETHEREUM_RPC_URL:-https://TODO_ETHEREUM_RPC_URL}
      - SEPOLIA_RPC_URL=${SEPOLIA_RPC_URL:-https://TODO_SEPOLIA_RPC_URL}
      - INDEXER_SYNC_INTERVAL_MS=${INDEXER_SYNC_INTERVAL_MS:-60000}
      - INDEXER_MAX_SNAPSHOTS_PER_WALLET=${INDEXER_MAX_SNAPSHOTS_PER_WALLET:-100}
    ports:
      - "${API_PORT:-3000}:3000"
    restart: unless-stopped

  web:
    image: ${WEB_IMAGE:-TODO_WEB_IMAGE}
    container_name: crosschain-web
    environment:
      - NODE_ENV=production
      - NEXT_PUBLIC_API_URL=${NEXT_PUBLIC_API_URL:-http://api:3000}
      - WEB_PORT=${WEB_PORT:-3001}
    ports:
      - "${WEB_PORT:-3001}:3001"
    depends_on:
      - api
    restart: unless-stopped


